

# Copie VMDK

1. Faire 3 copies simples du VMDK (CTRL C+ CTRL V)
2. Vérifier l'intégrité des hash

```powershell
get-date -Format "dddd MM/dd/yyyy HH:mm K" ; Get-Filehash <path\to\file.vmdk> -Algorithms MD5
```

3. Copier les VMDK au format RAW avec VirtualBox

```powershell
.\VBoxManage.exe clonemedium <path\src\to\file.vmdk> <path\dst\file.raw> --format raw
```


# Collecte

1. Monter le support cloné avec FTK Imager
2. Récupérer les ruches dans C:\Windows\System32\config et C:\Users\%USER%
	1. SYSTEM
	2. SOFTWARE
	3. SAM
	4. SECURITY
3. Récupérer Amcache.hve -> C:\Windows\appcompat\Programs
4. Récupérer la $MFT et déshériter le fichier de ses attributs SH

```powershell
attrib -S -H $MFT
```

5. Récupérer les fichier de journaux windows -> C:\Windows\System32\winevt\Logs
6. Récupérer les Prefetchs -> C:\Windows\Prefetch
7. Créer la timeline depuis la $MFT avec MFTECmd.exe

```powershell
.\MFTECmd.exe -f $MFT --csv .\Timeline.csv
```

8. Visualiser la timeline avec TimeLine Explorer
9. Parser Amcache au format CSV avec AmcacheParser

```powershell
 .\AmcacheParser.exe -f E:\WIN-DEV\Evidences\Ruches\Amcache.hve --csv E:\WIN-DEV\Evidences\ --csvf amcache.csv
```

10. Parser Shimcache au format CSV avec AppCompatCacheParser

```powershell
.\AppCompatCacheParser.exe -f E:\WIN-DEV\Evidences\Ruches\SYSTEM -t --csv E:\WIN-DEV\Evidences\ --csvf shimcache.csv
```