

# Enumération des defenses

Check des règles Applocker Local

```
powerpick Get-AppLockerPolicy -Effective | select -ExpandProperty RuleCollections
```

 Test Applocker policy Local

```powershell
powerpick Get-AppLockerPolicy -Local | Test-AppLockerPolicy -path C:\Windows\System32\cmd.exe -User Everyone
```

Check Defender (False = Protection en temps réel active)

```powershell-session
powerpick Get-MpPreference
```





# Identifier les privesc possibles


> [!Warning]
> A lancer depuis un processus svchost.exe

SharpUp en mode audit.

```
spawnto_x64 "C:\Windows\sysnative\svchost.exe"
```

```
execute-assembly C:\Tools\SharpUp\SharpUp\bin\Release\SharpUp.exe audit
```

