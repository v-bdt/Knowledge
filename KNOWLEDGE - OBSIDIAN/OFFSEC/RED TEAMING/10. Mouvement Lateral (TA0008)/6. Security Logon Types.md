

## Logon Types

- #### Interactive
    
    The user is logging on interactively.
    
- #### Network
    
    The user is logging on over the network.
    
- #### Batch
    
    The logon is for a batch process (i.e. scheduled task).
    
- #### Service
    
    The logon is for a service account.
    
- #### NetworkCleartext
    
    The logon is a network logon with plaintext credentials.
    
- #### NewCredentials
    
    Allows the caller to clone its current token and specify new credentials for outbound connections (i.e. runas /netonly).
    
- #### RemoteInteractive
    
    The logon is via a Remote Desktop session that is both remote and interactive.



Le LogonType **Network**, utilisé par WinRM et PsExec ne charge pas les credentials en mémoire LSASS. Pour cette raison nous pouvons avoir des erreurs lors d'exécution de scripts et tentative d'accès au réseau à partir de notre session. (KERBEROS DOUBLE HOP Problem)

```
beacon> powershell-import C:\Tools\PowerSploit\Recon\PowerView.ps1
beacon> powerpick Get-DomainTrust

ERROR: Exception calling "FindOne" with "0" argument(s): "An operations error occurred.
ERROR: "
ERROR: At line:6330 char:50
ERROR: + ... $PSBoundParameters['FindOne']) { $Results = $CompSearcher.FindOne() }
ERROR: +                                      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ERROR:     + CategoryInfo          : NotSpecified: (:) [], MethodInvocationException
ERROR:     + FullyQualifiedErrorId : DirectoryServicesCOMException
ERROR:  
ERROR: Exception calling "FindAll" with "0" argument(s): "An operations error occurred.
ERROR: "
ERROR: At line:19691 char:24
ERROR: +                 else { $Results = $TrustSearcher.FindAll() }
ERROR: +                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ERROR:     + CategoryInfo          : NotSpecified: (:) [], MethodInvocationException
ERROR:     + FullyQualifiedErrorId : DirectoryServicesCOMException
ERROR:
```

La solution est d'usurper un Token (make token) ou faire un Pass the ticket dans la session si vraiment nécessaire.