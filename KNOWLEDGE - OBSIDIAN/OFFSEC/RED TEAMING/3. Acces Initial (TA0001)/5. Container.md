
Les containers permettent de faire un bundle des dépendances (Trigger, Payload et Decoy) en un seul fichier.

# Mark of the Web

MotW -> Zone Identifier qui indique que le fichier est potentiellement non sécurisé.

Visible depuis les propriétés du fichier ou en powershell

![[Pasted image 20250911181558.png]]

```powershell
Get-Content -Stream Zone.Identifier .\test.pdf
[ZoneTransfer]
ZoneId=3
ReferrerUrl=https://s28.q4cdn.com/392171258/files/doc_downloads/test.pdf
HostUrl=https://s28.q4cdn.com/392171258/files/doc_downloads/test.pdf
```


L'idée est soit de Zipper les fichiers, les graver dans un ISO / IMG ou dans un WIM afin de bypasser ce MotW (Ne fonctionne plus pour les Zip apparemment -> https://github.com/nmantani/archiver-MOTW-support-comparison). Si possible de protéger le fichier avec un mot de passe cela ajoute une couche d'obfuscation supplémentaire.

Tool automatisé pour générer un container -> https://github.com/mgeeky/PackMyPayload

génération d'un container .zip en cachant les fichiers avec l'option H.

```
python3 PackMyPayload.py -H decoy.xlsx,payload.xlam package.zip
```
