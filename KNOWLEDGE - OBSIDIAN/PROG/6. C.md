
1. [[#Code minimal]]

2. [[#Programmation Modulaire]]
3. [[#Processus de compilation]]
4. [[#Directives de préprocesseur]]

5. [[#Fonctions]]
6. [[#Variables]]
7. [[#Gestion des chaines de caractères]]
8. [[#Constantes]]
9. [[#Pointeurs]]
10. [[#Tableaux]]
11. [[#Input & Output]]
12. [[#Arithmétique]]
13. [[#Incrémentation & Décrémentation]]
14. [[#Opérateurs de comparaison & logique]]
15. [[#Structure conditionnelles & Boucles]]
16. [[#Créer un type de variable]]
17. [[#Manipuler des fichiers]]
18. [[#Allocation Dynamique de mémoire]]


19. [[#Jeu du PENDU]]


20. [[#Vulnérabilités Communes]]


---
# Code minimal


Directives de préprocesseur (import de bibliothèques) + déclaration de notre fonction main.

```C
#include <stdio.h> // Lib qui permet de gérer les entrées / sortie (toujours nécessaire)
#include <stdlib.h>


// Fonction main
int main(int argc, char *argv[])
{
    printf("Hello world!\n"); // Affiche le texte "Hello World!"
    return 0; // retourne la valeur 0 si pas d'erreur
}
```


---
# Programmation Modulaire

### Fichiers C

On créer des fichiers .c qui vont contenir nos fonctions dans le répertoire "Source" du projet.

- main.c -> va contenir notre fonction main
- calcul.c -> va contenir nos fonctions relatives aux calculs par exemple

calcul.c
```C
#include <stdio.h> // Lib qui permet de gérer les entrées / sortie (toujours nécessaire)
#include <stdlib.h>

int triple(int nombre)
{
    int resultat = 0;

    resultat = 3 * nombre;  // On multiplie le nombre fourni par 3
    return resultat;       // On retourne la variable resultat qui vaut le triple de nombre
}

...
```

### Fichiers de headers

On créer des fichiers .h qui vont contenir les prototypes de nos fonctions dans le répertoire "Headers" du projet. Le nom du fichier doit être le même que le fichier .c associé. On pourra ensuite importer les fonctions dans notre main grâce aux directives de préprocesseur.

calcul.h

```
#ifndef DEF_CALCUL
#define DEF_CALCUL

// Les lignes suivante sont les prototypes des fonctions triple et aireRectangle définies dans calcul.c :

int triple(int nombre);
double aireRectangle(double largeur, double hauteur);


#endif
```


import des fonctions de calcul.h dans notre main.c et appel de la fonction triple dans main :

```C
#include <stdio.h> // Lib qui permet de gérer les entrées / sortie (toujours nécessaire)
#include <stdlib.h>
#include "calcul.h"

// Fonction main
int main(int argc, char *argv[])
{
	int nombreEntre = 0;
	printf("Entrez un nombre : %d",triple(nombreEntre));
	scanf_s("%d", &nombreEntre);
    return 0;
}
```


---
# Processus de compilation

- Le contenu des fichiers `.h` est inclus en haut des `.c` par un programme appelé **préprocesseur**. Les `.c` sont transformés en fichiers `.o` binaires par le **compilateur**. Les `.o` sont assemblés en un exécutable (`.exe`) par le "linker", aussi appelé **éditeur de liens**.

![[Pasted image 20251111215424.png]]

---
# Directives de préprocesseur

- [[#Inclure un fichier dans un autre]]
- [[#Associer une valeur à un mot (constante de préprocesseur)]]
- [[#Faire des calculs avec les define]]
- [[#Créer une macro (bout de code)]]
- [[#Créer des condition de préprocesseur]]
- [[#ifdef & ifndef]]


### Inclure un fichier dans un autre

```C
#include <Windows.h> // inclus l'api Win32 préinstallée
#include "fichier.h" // inclus fichier présent dans le projet
```


### Associer une valeur à un mot (constante de préprocesseur)

```C
#define TAILLE_MAX 1000 // définit TAILLE_MAX a 1000
...

char chaine1[TAILLE_MAX]; // remplacera le mot TAILLE_MAX par 1000 lors de la compilation
```


### Faire des calculs avec les define

(`addition (+), soustraction (-), multiplication (*), division (/) et modulo (%)`)

```C
#define LARGEUR_FENETRE 800
#define HAUTEUR_FENETRE 600
#define NOMBRE_PIXELS (LARGEUR_FENETRE * HAUTEUR_FENETRE)
```


### Créer une macro (bout de code)

sans paramètres en entrée

```C
#define RACONTER_SA_VIE() printf("Salut mon petit pere, je m'appelle Valentin, j'ai 26 ans et ..."); \
                          printf(" j'ai toutes mes dents\n"); \
                          printf("blablabla");


RACONTER_SA_VIE() // ne necessite pas de ;
```

avec paramètres en entrée

```C
#define MAJEUR(prenom, age) if (age >= 18 && age <= 80) \
					printf("%s, vous etes majeur\n", prenom); \
					else if (age > 80) \
					printf("Un pied dans la tombe"); \
					else \
					printf("%s, vous etes mineur\n", prenom);
					
MAJEUR("Valentin", 22) // affichera "Valentin,vous etes majeur"
MAJEUR(15) // affichera "Vous etes mineur"
MAJEUR(81) // affichera ...
```

### Créer des condition de préprocesseur

Le code sera compilé uniquement si la condition retourne vrai, sinon il n'apparaitra pas dans le programme final !

```C
#if condition
    /* Code source à compiler si la condition est vraie */
#elif condition2
    /* Sinon si la condition 2 est vraie compiler ce code source */
#endif
```

### ifdef & ifndef


ifdef -> Permet de compiler le code source pour ce qui a été définit.

```C
#define WINDOWS


#ifdef WINDOWS

/* Code source pour Windows */

#endif

#ifdef LINUX

/* Code source pour Linux */

#endif

#ifdef MAC

/* Code source pour Mac */

#endif
```

ifndef -> Utile pour éviter les boucles infinies (A METTRE DANS TOUS LES FICHIERS HEADERS)

```C
#ifndef DEF_NOMDUFICHIER // Si la constante n'a pas été définie le fichier n'a jamais été inclus

#define DEF_NOMDUFICHIER // On définit la constante pour que la prochaine fois le fichier ne soit plus inclus

/* Contenu de votre fichier .h (autres include, prototypes, define...) */

#endif
```



---
# Fonctions

Déclarer une fonction (exportable)

```C
type nomFonction(parametres)

{
	// Insérez vos instructions ici
}
```

Déclarer une fonction statique (Non exportable)

```C
static type nomFonction(parametres)
{
	// Insérez vos instructions ici
}
```

Type -> correspond à la valeur retournée par la fonction : int, double, float... (void si la fonction ne retourne rien) 
paramètres -> paramètres en entrée

exemple:

```C
int triple(int nombre)
{
    int resultat = 0;

    resultat = 3 * nombre;  // On multiplie le nombre fourni par 3
    return resultat;       // On retourne la variable resultat qui vaut le triple de nombre
}

// OU BIEN VERSION PLUS COURTE

int triple(int nombre)
{
    return 3 * nombre;       // On retourne directement le triple de nombre
}

```

Appeler la fonction dans main

```C

// Fonction main
int main(int argc, char* argv[])
{
	int nombreEntre = 0;

	printf("Entrez un nombre... ");
	scanf("%d", &nombreEntre);
	
	int nombreTriple = triple(nombreEntre);
	printf("Le triple de ce nombre est %d\n", nombreTriple);
	return 0;
}
```





---
# Variables

> [!Warning]
> - Sensible à la casse
> - Accents et symboles interdits
> - Nécessaire de déclarer le type de variable
> - Eviter les variables globales ou les définir en statique

- [[#Types de variables]]
- [[#Déclarer variable]]
- [[#Afficher le contenu d'une variable]]

## Types de variables

| Nom du type   | Permet                                                                                                    | Minimum           | Maximum           |
| ------------- | --------------------------------------------------------------------------------------------------------- | ----------------- | ----------------- |
| signed char   | stockage de caractère ou chaine de caractères sous forme de tableau / nombres entier positifs et négatifs | -128              | 127               |
| unsigned char | stockage de caractère ou chaine de caractères sous forme de tableau / nombres entier positifs             | 0                 | 255               |
| int           | stockage de nombres entier négatifs et positifs                                                           | -32 768           | 32 767            |
| unsigned int  | stockage de nombres entier positifs                                                                       | 0                 | 65 535            |
| long          | stockage de nombres entier négatifs et positifs                                                           | -2 147 483 648    | 2 147 483 647     |
| unsigned long | stockage de nombres entier positifs                                                                       | 0                 | 4 294 967 295     |
| float         | stockage de nombres décimaux                                                                              | 1.17549 x 10^-38  | 3.40282 x 10^+38  |
| double        | stockage de nombres décimaux                                                                              | 2.22507 x 10^-308 | 1.79769 x 10+308^ |

## Déclarer variable

Il est mieux d'initialiser les variables lors de leur déclaration

```c
int nombre_de_vies = 3; // nombre
char nom[] = "Nom"; // chaine de caractères (tableau qui contient plusieurs caractères)
```

variable locale statique dont la valeur sera conservée à la fin de l'exécution de la fonction.

```c
int fonction()
{
	static int nombre_de_vies = 3; // nombre
	// instructions
}

```

variable globale statique qui n'est accessible que depuis le fichier dans lequel elle est définie.

```C
static int nombre_de_vies = 3; // nombre

int fonction()
{
	// instructions
}
```


## Afficher le contenu d'une variable

| Format | Type attendu                |
| ------ | --------------------------- |
| "%s"   | char (chaine de caractères) |
| "%c"   | char (caractère unique)     |
| "%d"   | int                         |
| "%u"   | unsigned int                |
| "%ld"  | long                        |
| "%f"   | float                       |
| "%f"   | double                      |
| %p     |                             |

```C
printf("Il vous reste %d vies", nombre_de_vies);
```

possible d'afficher plusieurs variables

```C
printf("Monsieur %s il ne vous en reste plus que %d\n", nom, nombre_de_vies);
```


---
# Gestion des chaines de caractères

Nécessite d'importer la bibliothèque string.h

```C
#include <string.h>
```

Fonctions pour gérer les chaines :

| Fonction  | Utilité                                     |
| --------- | ------------------------------------------- |
| strlen    | Calculer la longueur de la chaine           |
| strncpy_s | Copier une chaine dans une autre            |
| strncat_s | Concatener 2 chaines                        |
| strcmp    | Comparer 2 chaines                          |
| strchr    | Rechercher un caractère                     |
| strpbrk   | Rechercher le premier caractère de la liste |
| strstr    | Rechercher une chaine dans une autre        |
| sprintf_s | Ecrire dans une chaine                      |


- Toute chaîne de caractères se termine par un caractère spécial appelé `\0`  qui signifie "fin de chaîne" en mémoire :
 ![[Pasted image 20251114230738.png]]


- [[#Calculer la longueur d'une chaine]]
- [[#Copier une chaine dans une autre]]
- [[#Concaténer 2 chaines]]
- [[#Comparer 2 chaines]]
- [[#Rechercher un caractère]]
- [[#Rechercher le premier caractère a partir d'une liste]]
- [[#Rechercher une chaine dans une autre]]
- [[#Ecrire dans une chaine de caractère]]


### Calculer la longueur d'une chaine

```C
char chaine[] = "Salut";
int longueurChaine= strlen(chaine);
printf_s("La chaine '%s' fait %d caracteres de long\n.", chaine, longueurChaine);
```

### Copier une chaine dans une autre

```C
char chaine[] = "Texte";
char copieChaine[100] = "";

strncpy_s(copieChaine, 100, chaine, 100); // On copie "chaine" dans "copieChaine" et on limite la taille des zones memoire allouées à 100 caractères.

// Si tout s'est bien passé, la copie devrait être identique à chaine

printf_s("chaine vaut : %s\n", chaine);

printf_s("copie vaut : %s\n", copieChaine);
```

### Concaténer 2 chaines

```C
/* On crée 5 chaînes. concat doit être assez grande pour accueillir
   le contenu des autres chaines en plus, sinon risque de plantage */
   
char concat[1000] = "";
char chaine1[] = "Salut";
char chaine2[] = " Valou";
char chaine3[] = " comment";
char chaine4[] = " vas-tu ?";

strncat_s(concat, 1000, chaine1, 10); // On concatène chaine1 dans concat
strncat_s(concat, 1000, chaine2, 10); // On concatène chaine2 dans concat
strncat_s(concat, 1000, chaine3, 10); // On concatène chaine3 dans concat
strncat_s(concat, 1000, chaine4, 10); // On concatène chaine4 dans concat
    
// Si tout s'est bien passé, cobncat vaut "Salut Valou comment vas-tu ?"
printf_s("concat vaut : %s\n", concat);
    
// chaine1 2 3 et 4 n'ont pas changées.
```

### Comparer 2 chaines

```C
char chaine1[] = "Texte de test";
char chaine2[] = "Texte de test";

if (strcmp(chaine1, chaine2) == 0) // Si chaînes identiques
{
	printf("Les chaines sont identiques\n");
}

else
{
	printf("Les chaines sont differentes\n");
}
```


### Rechercher un caractère

La fonction renvoie un pointeur vers le premier caractère qu'elle a trouvé, c'est-à-dire qu'elle renvoie l'adresse de ce caractère dans la mémoire. Elle renvoie `NULL` si elle n'a rien trouvé.

Dans l'exemple suivant, je récupère ce pointeur dans `suiteChaine`  :

```C
char chaine[] = "Texte de test";
char *suiteChaine = NULL;

suiteChaine = strchr(chaine, 'd');

if (suiteChaine != NULL) // Si on a trouvé quelque chose
{
	printf("Voici la fin de la chaine a partir du premier d : %s", suiteChaine);
}
else
{
	printf("Aucun caractere trouve.");
}
```

### Rechercher le premier caractère a partir d'une liste

```C
char *suiteChaine = NULL;
char chaine[] = "Texte de test";

// On cherche la première occurrence de x, d ou s dans "Texte de test"

suiteChaine = strpbrk(chaine, "xds");

if (suiteChaine != NULL)
{
	printf("Voici la fin de la chaine a partir du premier des caracteres trouves : %s", suiteChaine);
}
else
{
	printf("Aucun caractere trouve.");
}
```

### Rechercher une chaine dans une autre

```C
char *suiteChaine;

// On cherche la première occurrence de "test" dans "Texte de test" :
suiteChaine = strstr("Texte de test", "test");
if (suiteChaine != NULL)
{
    printf("Premiere occurrence de 'test' dans 'Texte de test' : %s\n", suiteChaine);
}
```

### Ecrire dans une chaine de caractère

```C
char chaine[100];

int age = 15;

// On écrit "Tu as 15 ans" dans chaine

sprintf_s(chaine, 100, "Tu as %d ans !", age);

// On affiche chaine pour vérifier qu'elle contient bien cela :

printf("%s", chaine);
```

---
# Constantes

Permet de déclarer une valeur immuable qui ne peut jamais changer lors de l'exécution du programme.

Il faut obligatoirement lui donner une valeur lors de sa déclaration.

```C
const int NOMBRE_DE_VIES_INITIALES = 5;
```


---
# Pointeurs

> [!Tip]
> Un pointeur pointe vers l'adresse mémoire d'une variable.
> On peut envoyer les pointeurs à des fonctions pour qu'ils modifient directement la variable originale et non une copie de celle ci.
> Utile dans le cas ou on veut retourner plusieurs valeurs d'une fonction.


```C
int age = 10; // declare la variable age.
int *pointeurSurAge = &age; // déclare une variable pointant sur l'adresse mémoire de la variable age.

char prenom[] = "Val"; // declare la variable prenom.
int *pointeurPrenom = &prenom; // déclare une variable pointant sur l'adresse mémoire de la variable prenom.

printf("%s", pointeurPrenom); // retourne l'adresse mémoire qui stocke prenom.
printf("%d", pointeurSurAge); // retourne l'adresse mémoire qui stocke age.
```

On peut également récupérer la valeur stockée dans l'adresse mémoire (déréférencement du pointeur)

```C
printf("%d", *pointeurSurAge); // retourne 10
```


Envoi de pointeurs dans une fonction

```C
void triplePointeur(int *pointeurSurNombre)
{
    *pointeurSurNombre *= 3; // On multiplie par 3 la valeur de nombre
}

int main(int argc, char *argv[])
{
    int nombre = 5;
    int *pointeurNombre = &nombre;

    triplePointeur(pointeurNombre); // On envoie l'adresse de nombre à la fonction
    printf("%d", nombre); // On affiche la variable nombre. La fonction a directement modifié la valeur de la variable car elle connaissait son adresse

    return 0;
}
```

---
# Tableaux

> [!Tip]
> Un tableau est considéré comme un pointeur


Déclarer un tableau

```c
int tableau[] = {1, 2, 3, 4, 5}; // Tableau contenant les chiffres 1 2 3 4 5
int tableau[5] = {1}; // Tableau qui contiendra 1 0 0 0 0
```

Afficher les cases d'un tableau (indice commençant à 0)

```C
printf("Case 1 : %d\n", tableau[0]); // Affichera 1
printf("Case 1 : %d\n", tableau[1]); // Affichera 2
printf("Case 1 : %d\n", tableau[2]); // Affichera 3
printf("Case 1 : %d\n", tableau[3]); // Affichera 4
printf("Case 1 : %d\n", tableau[4]); // Affichera 5
```

Afficher les cases d'un tableau avec une boucle for

```C
int tableau[] = {1, 2, 3, 4, 5}; // Tableau contenant les chiffres 1 2 3 4 5

for ( int i = 0; i < 5 ; i++ )
{
	printf("Case %d : %d\n", i, tableau[i]);
}
```

fonction pour afficher un tableau

```C
void afficheTableau(int tableau[], int tailleTableau) // On pourrait écrire int *tableau à la place de int tableau[] puisque c'est un pointeur
{
    int i;
 
    for (i = 0 ; i < tailleTableau ; i++)
    {
        printf("%d\n", tableau[i]);
    }
}
 
int main(int argc, char *argv[])
{
    int tableau[3] = {10, 15, 3};
 
    // On affiche le contenu du tableau
    afficheTableau(tableau, 3);
 
    return 0;
}

```


---
# Input & Output


Récupérer une saisie utilisateur dans une variable de type entier

```C
int age = 0;

printf("Quel age avez-vous ? : ");
scanf_s("%d", &age); // On demande d'entrer l'âge avec scanf_s
printf("Ah ! Vous avez donc %d ans !\n\n", age);
```

Récupérer une saisie utilisateur dans une variable de type tableau

```C
char nom[10];

printf("Quel est votre nom ? ");
fgets(nom, 10, stdin); // Limite les caractères à 10.
printf("Ah ! Vous vous appelez donc %s !\n\n", nom);
```


---
# Arithmétique

- [[#Opérations basiques]]
- [[#Operations avancées]]

### Opérations basiques

| Opération      | Signe |
| -------------- | ----- |
| Addition       | +     |
| Soustraction   | -     |
| Multiplication | *     |
| Division       | /     |
| Modulo         | %     |

```C
int nombre1 = 5;
int nombre2 = 2;

int addition = nombre1 + nombre2;

printf("%d", addition);
```


On peut également utiliser des raccourcis

```C
int nombre = 2;

nombre += 4; // nombre vaut 6...

nombre -= 3; // ... nombre vaut maintenant 3

nombre *= 5; // ... nombre vaut 15

nombre /= 3; // ... nombre vaut 5

nombre %= 3; // ... nombre vaut 2 (car 5 = 1 * 3 + 2)
```


### Operations avancées

Bibliothèque math.h :

https://course.oc-static.com/courses/19980/La+biblioth%C3%A8que+math%C3%A9matique+-+ANNEXE+%5BApprenez+%C3%A0+programmer+en+C%5D+.pdf

Permet d'effectuer des opérations plus avancées comme puissance, la racine carrée, l'arrondi, l'exponentielle, le logarithme, etc.

```C
#include <math.h>
```


---
# Incrémentation & Décrémentation


Incrémenter une variable :

```C
nombre = nombre + 1;
nombre++; //version raccourcie
```

Décrémenter une variable :

```C
nombre = nombre - 1;
nombre--; //version raccourcie
```

---
## Opérateurs de comparaison & logique


Opérateurs de comparaison :

| **Operator** | **Description**                             |
| ------------ | ------------------------------------------- |
| `==`         | is equal to                                 |
| `!=`         | is not equal to                             |
| `<`          | is less than in ASCII alphabetical order    |
| `>`          | is greater than in ASCII alphabetical order |
| ``<=``       | is lesser or equal to                       |
| ``>=``       | is greater or equal to                      |

Operateurs logique

| Operateur | Description |
| --------- | ----------- |
| &&        | ET          |
| \|\|      | OU          |
| !         | NON         |

---
# Structure conditionnelles & Boucles

[[#if, else if, else]]
[[#Booléens (Vrai / Faux)]]
[[#Switch]]
[[#Boucle while]]
[[#Boucle do... while]]
[[#Boucle for]]


## if, else if, else

#### Structure conditionnelle classique

```C
if ( age >= 18 && age <= 25 ) // Si l'âge est supérieur ou égal à 18 et inférieur ou égal à 25 
{
	printf ("Vous etes majeur et pas encore trop vieux!");
}

else if (!( age < 80 )) // Sinon, si l'age n'est pas inferieur à 80
{
	printf("Ca commence a etre dur...");
}

else if ( age > 4 || age > 25 ) // Sinon, si l'âge est au moins supérieur à 4 ou 25
{
	printf ("Bon t'es pas trop jeune quand meme...");
}

else // Sinon...
{
	printf ("Aga gaa aga gaaa"); // Langage bébé, vous pouvez pas comprendre
}
```


#### Structure conditionnelle ternaire

Le point d'interrogation permet de dire « est-ce que tu es majeur ? ». Si oui, alors on met la valeur 18 dans `age`. Sinon (le `:` signifie `else` ici), on met la valeur 17.

```C
int age = 18;
int autorisation = (age >= 18) ? 1 : 0;
```

équivaut à la structure conditionnelle classique suivante.

```C
int age = 18;
int autorisation = 0;

if ( age >= 18 )
{
	autorisation = 1;
}
else
{
	autorisation = 0;
}
```

## Booléens (Vrai / Faux)

> [!Tip]
> En langage C, il n'existe pas de type de variable "booléen". Donc, on est obligé d'utiliser un type entier comme `int` pour gérer les booléens.
> 
> Souvent, on fera un test `if` sur une variable booléenne :


```C
int age = 20;
int majeur = age >= 18;
int vaccin_ok = 1;
int non_vaccin = 0;

if (majeur && vaccin_ok)
{
    printf("Vous etes majeur et vaccine !");
}

if (majeur && non_vaccin)
{
    printf("Vous etes majeur mais non vaccine !");
}

else
{
    printf("Vous etes mineur");
}
```

## Switch

Alternative au if, else if, else

```C
int choix = 0;

printf("=== Menu ===\n");
printf("1. Royal Cheese\n");
printf("2. Mc Deluxe\n");
printf("3. Mc Bacon\n");
printf("4. Big Mac\n");
printf("Votre choix ? :");
scanf_s("%d", &choix);

switch (choix)

{
case 1:
	printf("tu as choisi le menu Royal Cheese");
	break; // instruction break pour ne pas afficher le reste.

case 2:
	printf("tu as choisi le menu Mc Deluxe");
	break;

case 3:
	printf("tu as choisi le menu Mc Bacon");
	break;

case 4:
	printf("tu as choisi le menu Big Mac");
	break;

default:
	printf("Mauvais choix.");
	break;
}
```

on peut également switch sur une fonction

```C
int menu()
{
	int choix = 0;
	while (choix < 1 || choix > 4)
	{
	printf("Menu :\n");
	printf("1 : Poulet de dinde aux escargots rotis a la sauce bearnaise\n");
	printf("2 : Concombres sucres a la sauce de myrtilles enrobee de chocolat\n");
	printf("3 : Escalope de kangourou saignante et sa gelee aux fraises poivree\n");
	printf("4 : La surprise du Chef (j'en salive d'avance...)\n");
	printf("Votre choix ? ");
	scanf_s("%d", &choix);
	}

	return choix;
}

int main(int argc, char *argv[])
{
	switch (menu())
	{
		case 1:
		printf("Vous avez pris le poulet\n");
		break;

		case 2:
		printf("Vous avez pris les concombres\n");
		break;

		case 3:
		printf("Vous avez pris l'escalope\n");
		break;

		case 4:
		printf("Vous avez pris la surprise du Chef. Vous etes un sacre aventurier dites donc !\n");
		break;
	}
}

```


## Boucle while

```C
int compteur = 0;

while (compteur < 10)

{
	printf("Bienvenue sur OpenClassrooms !\n");
	compteur++;
}
```


## Boucle do... while

effectue les instructions définies au moins une fois.

```C
int compteur = 0;

do
{
    printf("Bienvenue sur OpenClassrooms !\n");
    compteur++;
} while (compteur < 10);
```

## Boucle for

```C
for (int compteur = 0 ; compteur < 10 ; compteur++)
{
    printf("Bienvenue sur OpenClassrooms !\n");
}
```



---
# Créer un type de variable

> [!Tip]
> A faire dans les fichiers Headers idéalement

[[#Structures]]
- [[#Définir une structure]]
- [[#Utiliser une structure dans une fonction]]
- [[#Créer un alias de structure]]
- [[#Définir un pointeur sur une structure]]
- [[#Envoyer structure à une fonction]]

[[#Enumération]]
- [[#Définir une énumération]]
- [[#Utiliser une énumération dans une fonction]]


## Structures
### Définir une structure

```C
struct str_NomDeVotreStructure
{
	int variable1;
	int variable2;
	int autreVariable;
	double nombreDecimal;
};

// Exemple de structure de type Coordonnees

struct str_Coordonnees
{
	int x; // Abscisses
	int y; // Ordonnées
};
```

structure contenant des tableaux

```C
struct str_Personne
{
	char nom[100];
	char prenom[100];
	char adresse[1000];
	int age;
	int etudiant; // Booléen : 1 = etudiant, 0 = non etudiant
};
```

### Utiliser une structure dans une fonction

```C
#include "main.h" // Inclusion du .h qui contient les prototypes et structures

int main(int argc, char *argv[])
{
    struct str_Coordonnees point = {0, 0}; // Création d'une variable "point" de type Coordonnees et initialisation de x et y à 0.
    
    point.x = 10; // on défini la coordonée x à 10.
    point.y = 20; // on défini la coordonée y à 20.

    return 0;
}
```

### Créer un alias de structure

On définit "typedef" dans le fichier de header.

```C
typedef struct str_Coordonnees Coordonnees;
struct str_Coordonnees
{
    int x;
    int y;
};
```

Puis on peut utiliser Coordonnees au lieu de struct str_Coordonnees dans notre code.

```C
int main(int argc, char *argv[])
{
	Coordonnees point; // L'ordinateur comprend qu'il s'agit de "struct Coordonnees" grâce au typedef

	return 0;
}
```


### Définir un pointeur sur une structure

De la même manière qu'un pointeur classique

```C
struct str_Coordonnees *point = NULL;

// ou

Coordonnees *point = NULL;
```

### Envoyer structure à une fonction

En utilisant les pointeurs

```C
void initialiserCoordonnees(struct str_Coordonnees *point)
{
	// Initialisation de chacun des membres de la structure ici
	(*point).x = 0; // on declare x = 0
	(*point).y = 0; // on declare y = 0
	// ou alternative plus rapide
	point->x = 0;
	point->y = 0;	
}

int main(int argc, char *argv[])
{
	struct str_Coordonnees monPoint;
	initialiserCoordonnees(&monPoint);

	return 0;
}
```



## Enumération
### Définir une énumération

Différent de la structure ne contient pas de sous-variable mais des valeurs définis.

```C
typedef enum Volume Volume;
enum Volume
{
	FAIBLE, MOYEN, FORT // lors de l'initialisation, FAIBLE vaut 0, MOYEN 1, FORT 2
	//ou on initialise nous même les valeurs precise.
	MUET = 0, FAIBLE = 10, MOYEN = 50, FORT = 100 // 0%, 10%, 50% et 100%
	
	MUET = 0, FAIBLE = 10, MOYEN = 50, FORT // ici FORT vaut 51% (+1 par rapport à la précedente valeur définie)
};
```


### Utiliser une énumération dans une fonction

```C
int main(int argc, char *argv[])
{
	enum Volume musique = MOYEN;
	
	musique = FAIBLE;
	musique = FORT;

	return 0;
}
```


---
# Manipuler des fichiers

> [!Important]
> Nécessite stdlib.h

- [[#Ouvrir et fermer un fichier]]
- [[#Lire dans un fichier]]
- [[#Ecrire dans un fichier]]
- [[#Se déplacer dans un fichier]]
- [[#Renommer un fichier]]
- [[#Supprimer un fichier]]

### Ouvrir et fermer un fichier

On ouvre le fichier, on vérifie qu'il est ouvert, on lit / écrit dedans, puis on le ferme afin de libérer la mémoire.

```C
#include <stdlib.h>

int main(int argc, char *argv[])
{
	FILE* fichier = NULL; // initialise le pointeur fichier de type FILE
	
	fichier = fopen("test.txt", "r"); //ouvre le fichier en LECTURE SEULE
	fichier = fopen("test.txt", "w"); //ouvre le fichier en ECRITURE SEULE ou le crée s'il n'existe pas.
	fichier = fopen("test.txt", "r+"); //ouvre le fichier en LECTURE / ECRITURE
	fichier = fopen("test.txt", "a"); //ouvre le fichier pour ECRIRE du texte à la fin du fichier
	fichier = fopen("test.txt", "a+"); //ouvre le fichier pour LIRE / ECRIRE du texte à la fin du fichier
	
	if (fichier != NULL)
	{
		// On peut lire et écrire dans le fichier
		fclose(fichier); // On ferme le fichier qui a été ouvert
	}
	else
	{
		// On affiche un message d'erreur si on veut
		printf("Impossible d'ouvrir le fichier test.txt");
	}
	
	return 0;
}
```

### Lire dans un fichier

Lire caractères un par un

```C
int caractereActuel = 0;

// Boucle de lecture des caractères un à un
do
{
	caractereActuel = fgetc(fichier); // On lit le caractère
	printf("%c", caractereActuel); // On l'affiche
} while (caractereActuel != EOF); // On continue tant que fgetc n'a pas retourné EOF (fin de fichier)

fclose(fichier);
```

Lire une chaine de caractères (s'arrête au premier \n)

```C
#define TAILLE_MAX 1000 // Tableau de taille 1000

char chaine[TAILLE_MAX] = ""; // Chaîne vide de taille TAILLE_MAX
fgets(chaine, TAILLE_MAX, fichier); // On lit maximum TAILLE_MAX caractères du fichier, on stocke le tout dans "chaine"
printf("%s", chaine); // On affiche la chaîne

fclose(fichier);
```

Lire plusieurs chaines de caractères (boucle)

```C
char chaine[TAILLE_MAX] = ""; // Chaîne vide de taille TAILLE_MAX

while (fgets(chaine, TAILLE_MAX, fichier) != NULL) // On lit le fichier tant qu'on ne reçoit pas d'erreur (NULL)
{
	printf("%s", chaine); // On affiche la chaîne qu'on vient de lire
}

fclose(fichier);
```

Lire une chaine formatée

```C
int score[3] = {0}; // Tableau des 3 meilleurs scores

fscanf(fichier, "%d %d %d", &score[0], &score[1], &score[2]);
printf("Les meilleurs scores sont : %d, %d et %d", score[0], score[1], score[2]);

fclose(fichier);
```

### Ecrire dans un fichier

```C
fputc('A', fichier); // Écriture du caractère A
fputs("Salut les développeurs !", fichier); // Écriture d'une chaine de caractères.

int age = 25;

fprintf(fichier, "Le Monsieur qui utilise le programme, il a %d ans", age); // Chaine "formatée" qui retourne la variable age.

fclose(fichier);
```


### Se déplacer dans un fichier

Indiquer la position du curseur dans le fichier

```C
ftell(fichier);
```


Positionner le curseur à un endroit précis

> [!Warning]
> Se comporte bizarrement en mode texte -> utiliser seulement se placer au debut ou a la fin.
> Libre de faire ce que l'on veut en mode binaire

```C
fseek(fichier, 2, SEEK_SET); // 2 caractères à partir du début
fseek(fichier, -1, SEEK_CUR); // -1 caractères à partir de la position courante
fseek(fichier, 2, SEEK_END); // 2 caractères à partir de la fin
```


Replacer le curseur en début de fichier

```C
rewind(fichier); // equivaut à fseek(fichier, 0, SEEK_SET);
```

### Renommer un fichier

```C
rename("test.txt", "test_renomme.txt");
```

### Supprimer un fichier

```C
remove("test.txt");
```


---
# Allocation Dynamique de mémoire

- [[#Trouver la taille d'une variable en fonction de son type]]
- [[#Allouer manuellement de la mémoire]]

### Trouver la taille d'une variable en fonction de son type

```C
sizeof(char)); // Taille d'un char
sizeof(char*)); // Taille d'un pointeur char
sizeof(int)); // Taille d'un int
sizeof(long)); //...
sizeof(double)); //...
sizeof(Coordonnees)); // Taille d'un struct Coordonnees (Plus une structure contient de sous-variables, plus elle prend de mémoire.)

printf("char : %d octets\n", sizeof(char));
printf("int : %d octets\n", sizeof(int));
printf("long : %d octets\n", sizeof(long));
printf("double : %d octets\n", sizeof(double));
 ```

Si notre type Coordonnees prend 8 octets en mémoire et qu'on définit un tableau de 100 alors la taille totale allouée sera de 800

```C
Coordonnees tableau[100] = NULL;
```

### Allouer manuellement de la mémoire

> [!Important]
> Necessite <stdlib.h>

1. On alloue la mémoire
2. On vérifie que la mémoire est bien allouée.
3. On libère la mémoire (Evite les use after free)


```C
int *memoireAllouee = NULL; // On crée un pointeur sur int

memoireAllouee = malloc(sizeof(int)); // La fonction malloc inscrit dans notre pointeur l'adresse qui a été reservée.

if (memoireAllouee == NULL) // Si l'allocation a échoué
{
	exit(0); // On arrête immédiatement le programme
}

// On peut continuer le programme normalement sinon et utiliser la mémoire
printf("Quel age avez-vous ? ");
scanf("%d", memoireAllouee);
printf("Vous avez %d ans\n", *memoireAllouee);

free(memoireAllouee); // On n'a plus besoin de la mémoire, on la libère
```


Création d'un tableau dont la taille n'est connue qu'a l'exécution

```C
int nombreDAmis = 0, i = 0;
int* ageAmis = NULL; // Ce pointeur va servir de tableau après l'appel du malloc

// On demande le nombre d'amis à l'utilisateur
printf("Combien d'amis avez-vous ? ");
scanf("%d", &nombreDAmis);

if (nombreDAmis > 0) // Il faut qu'il ait au moins un ami (je le plains un peu sinon :p)
{
	ageAmis = malloc(nombreDAmis * sizeof(int)); // On alloue de la mémoire pour le tableau
	if (ageAmis == NULL) // On vérifie si l'allocation a marché ou non
	{
		exit(0); // On arrête tout
	}

	// On demande l'âge des amis un à un

	for (i = 0 ; i < nombreDAmis ; i++)
	{
		printf("Quel age a l'ami numero %d ? ", i + 1);
		scanf("%d", &ageAmis[i]);
	}

	// On affiche les âges stockés un à un
	printf("\n\nVos amis ont les ages suivants :\n");

	for (i = 0 ; i < nombreDAmis ; i++)
	{
		printf("%d ans\n", ageAmis[i]);
	}

	// On libère la mémoire allouée avec malloc, on n'en a plus besoin
	free(ageAmis);
}
```



---
# Jeu du PENDU

```C
#include <stdio.h>
#include <stdlib.h>


int tailleMot(char motSecret[])
{
    int nombreLettre = 0;
    for(int i = 0; motSecret[i] != '\0'; i++)
    {
        nombreLettre++;
    }
    return nombreLettre;
}

char lireCaractere()
{
    char caractere = 0;
 
    caractere = getchar(); // On lit le premier caractère
    caractere = toupper(caractere); // On met la lettre en majuscule si elle ne l'est pas déjà
 
    // On lit les autres caractères mémorisés un à un jusqu'au \n (pour les effacer)
    while (getchar() != '\n') ;
 
    return caractere; // On retourne le premier caractère qu'on a lu
}

void initTableau(int* lettreTrouvee, int taille)
{
    for(int i = 0; i < taille; i++)
    {
        lettreTrouvee[i] = 0;
    }
}

int gagne(int *lettreTrouvee, int nombreLettres)
{
    int i = 0;
    int joueurGagne = 1;

    for (i = 0 ; i < nombreLettres ; i++)
    {
        if (lettreTrouvee[i] == 0)
            joueurGagne = 0;
    }

    return joueurGagne;
}


int rechercheLettre(char lettre, char motSecret[], int* lettreTrouvee)
{
    int i = 0;
    int bonneLettre = 0;

    // On parcourt motSecret pour vérifier si la lettre proposée y est
    for (i = 0 ; motSecret[i] != '\0' ; i++)
    {
        if (lettre == motSecret[i]) // Si la lettre y est
        {
            bonneLettre = 1; // On mémorise que c'était une bonne lettre
            lettreTrouvee[i] = 1; // On met à 1 la case du tableau de booléens correspondant à la lettre actuelle
        }
    }

    return bonneLettre;
}

int main(int argc, char* argv[])
{
    char lettre = 0; // Stocke la lettre proposée par l'utilisateur (retour du scanf)
    char motSecret[] = "ROUGE"; // C'est le mot à trouver
    int coupsRestants = 10; // Compteur de coups restants (0 = mort)
    int nombreLettres = tailleMot(motSecret);
    int *lettreTrouvee = NULL;// Tableau de booléens. Chaque case correspond à une lettre du mot secret. 0 = lettre non trouvée, 1 = lettre trouvée //Q1
    lettreTrouvee = malloc(nombreLettres * sizeof(int)); //Q2
    initTableau(lettreTrouvee, nombreLettres); //Q3

    printf("Bienvenue dans le Pendu !\n\n");
    
    while (coupsRestants > 0 && !gagne(lettreTrouvee, nombreLettres))
    {
        printf("\n\nIl vous reste %d coups a jouer", coupsRestants);
        printf("\nQuel est le mot secret ? ");

        /* On affiche le mot secret en masquant les lettres non trouvées
                Exemple : *A**ON */
        for (int i = 0 ; i < nombreLettres ; i++)
        {
            if (lettreTrouvee[i])
                printf("%c", motSecret[i]);
            else
                printf("*");
        }
        
        printf("\nProposez une lettre : ");
        lettre = lireCaractere();
        
        // Si ce n'était PAS la bonne lettre
        if (!rechercheLettre(lettre, motSecret, lettreTrouvee))
        {
            coupsRestants--; // On enlève un coup au joueur
        }
    }

    if (gagne(lettreTrouvee, nombreLettres))
        printf("\n\nGagne ! Le mot secret etait bien : %s\n", motSecret);
    else
        printf("\n\nPerdu ! Le mot secret etait : %s \n", motSecret);

    return 0;
}
```


---
# Vulnérabilités Communes

https://medium.com/@capturethebugs/common-c-vulnerabilities-56ffad22581e